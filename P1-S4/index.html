
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://https:/marcgnd.github.io/mkdocs-marc-sabate/P1-S4/">
      
      
        <link rel="prev" href="../P1-S3/">
      
      
        <link rel="next" href="../P1-S5/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>P1 S4 - MkDocs Marc Sabate</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#raid" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MkDocs Marc Sabate" class="md-header__button md-logo" aria-label="MkDocs Marc Sabate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MkDocs Marc Sabate
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              P1 S4
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Implantaci√≥ de sistemes operatius

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P1-S1/" class="md-tabs__link">
        
  
  
    
  
  P1 S1

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P1-S2/" class="md-tabs__link">
        
  
  
    
  
  P1 S2

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P1-S3/" class="md-tabs__link">
        
  
  
    
  
  P1 S3

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  P1 S4

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P1-S5/" class="md-tabs__link">
        
  
  
    
  
  P1 S5

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P2-S1/" class="md-tabs__link">
        
  
  
    
  
  P2 S1

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P2-S2/" class="md-tabs__link">
        
  
  
    
  
  P2 S2

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P2-S3/" class="md-tabs__link">
        
  
  
    
  
  P2 S3

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P2-S4/" class="md-tabs__link">
        
  
  
    
  
  P2 S4

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../P2-S5/" class="md-tabs__link">
        
  
  
    
  
  P2 S5

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MkDocs Marc Sabate" class="md-nav__button md-logo" aria-label="MkDocs Marc Sabate" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MkDocs Marc Sabate
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implantaci√≥ de sistemes operatius
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P1-S1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P1 S1
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P1-S2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P1 S2
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P1-S3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P1 S3
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    P1 S4
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    P1 S4
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#raid" class="md-nav__link">
    <span class="md-ellipsis">
      RAID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raid-1" class="md-nav__link">
    <span class="md-ellipsis">
      RAID 1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raid-5" class="md-nav__link">
    <span class="md-ellipsis">
      RAID 5
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enllacos-dinteres-webgrafia" class="md-nav__link">
    <span class="md-ellipsis">
      Enlla√ßos d'inter√©s / Webgrafia
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P1-S5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P1 S5
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2-S1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2 S1
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2-S2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2 S2
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2-S3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2 S3
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2-S4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2 S4
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../P2-S5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2 S5
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h2 id="raid">RAID</h2>
<p>EL RAID es una eina que ens permet combinar diversos discs en una sola unitat l√≤gica per dona redundancia a les dades. Aix√≠ en cas de perdua poden recuperar. Hi han diferents tipus de raids:</p>
<ul>
<li>
<p>RAID 0: Avui en dia es considera obsolet. Consisteix en dividir les dades i distribuir-les entre discs sense redundancia. El nivell de seguretat es pr√†cticament nul, ja que pots perdre les dades f√†cilment.
<img alt="RAID0" src="../RAID-0.png" /></p>
</li>
<li>
<p>RAID 1: Funciona amb el metode "espill" que consisteix en fer una copia exacta de les dades en un altre disc, aix√≤ ens dona redundancia (es com un copia de seguretat en temps real).
<img alt="RAID1" src="../RAID-1.png" /></p>
</li>
<li>
<p>RAID 5: Utilitza com a minim tres discs, tot i que tamb√© es pot fer amb quatre. El sistema d'emmagatzematge reparteix l'informaci√≥ entre tots els discs menys a un que es l'utilitzat per la paritat, en cas de fallar un disc pots recuperar l'informaci√≥.
<img alt="RAID5" src="../RAID-5.jpg" /></p>
</li>
<li>
<p>RAID 6: El funcionament es exactament igual que l'anterior, la diferencia principal es que la paritat es guarda en dos discs.
<img alt="RAID6" src="../RAID-6.jpg" /></p>
</li>
</ul>
<h2 id="raid-1">RAID 1</h2>
<p>En aquest primer apartat veurem com configurar un RAID1. </p>
<ul>
<li>EN primer lloc necessitem el paquet mdadm, que es el que ens permet instal¬∑lar i configurar els RAIDs</li>
</ul>
<p><img alt="RAID1" src="../RAID1.png" /></p>
<ul>
<li>
<p>Un cop el paquet esta instal¬∑lat configurarem els discs amb la comanda que ja coneixem <code>fdisk</code> els discs que modifiquem haur√†n de cumplir la seg√ºent configuraci√≥-
<img alt="RAID1-2" src="../RAID1-2.png" /></p>
</li>
<li>
<p>En acabar la configuraci√≥ consultarem les particions i disc de la nostra m√†quina i ens assegurarem de que el format tingui autodetecci√≥ de RAID Linux.
<img alt="RAID1-3" src="../RAID1-3.png" /></p>
</li>
<li>
<p>A continuaci√≥ crearem una carpeta per fer proves, i li doanrem els permisos que es mostren a continuaci√≥.
<img alt="RAID1-4" src="../RAID1-4.png" /></p>
</li>
<li>
<p>A continuaci√≥ donarem el format al RAID amb aquesta comanda, el que fem es basicament crear el RAID amb el nivell que es el n√∫mero de RAID i despr√©s indiquem el n√∫mero de dispositius i quins son. 
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb1 /dev/sdc1
</code></pre></div>
<img alt="RAID1-5" src="../RAID1-5.png" /></p>
</li>
<li>
<p>Ara donarem el format d'arxius a l'array del RAID, amb la seg√ºent comanda.
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>mkfs.ext4 /dev/md0
</code></pre></div>
<img alt="RAID1-6" src="../RAID1-6.png" /></p>
</li>
<li>
<p>Per comprovar que s'ha creat tot correctament utilitzarem la comanda: 
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>mdadm --detail /dev/md0
</code></pre></div>
<img alt="RAID1-7" src="../RAID1-7.png" /></p>
</li>
<li>
<p>Seguidament executarem les seg√ºents comandes per crear un fitxer de configuraci√≥ per al RAID.
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>mdadm --detail --scan &gt; /etc/mdadm/mdadm.conf
</code></pre></div>
<img alt="RAID1-8" src="../RAID1-8.png" /></p>
</li>
<li>
<p>Dins del fitxer escriurem la seg√ºent linea <code>DEVICE /dev/sdb1 /dev/sdc1</code>.</p>
</li>
</ul>
<p><img alt="RAID1-9" src="../RAID1-9.png" /></p>
<ul>
<li>
<p>Com ja sabem per muntar permanent el RAID haurem de consigurar el fitxer fstab 
<img alt="RAID1-10" src="../RAID1-10.png" /></p>
</li>
<li>
<p>Un cop feta la configuraci√≥ reiniciem els serveis. Muntarem el disc i utilitzarem la seg√ºent comanda <code>update-initramfs -u -k all</code>.
<img alt="RAID1-11" src="../RAID1-11.png" />
<img alt="RAID1-12" src="../RAID1-12.png" />
<img alt="RAID1-13" src="../RAID1-13.png" /></p>
</li>
<li>
<p>Despr√©s de fer tots els passos comprovarem que el RAID esta correctament configurat un cop es reinicia el sistema.
<img alt="RAID1-14" src="../RAID1-14.png" /></p>
</li>
<li>
<p>Crearem una serie de directoris i fitxers per fer proves 
<img alt="RAID1-15" src="../RAID1-16.png" /></p>
</li>
<li>
<p>A continuaci√≥ treurem un disc i veurem que podem seguir treballant amb les dades. Com es pot apreciar el disc que hem desmuntat es troba en estat <code>faulty</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>mdadm /dev/md0 -f /dev/sdb1
</code></pre></div>
<img alt="RAID1-16" src="../RAID1-17.png" /></p>
</li>
<li>
<p>Un cop fet el pas anterior eliminarem el disc amb el modificador <code>-r</code> i veurem que el seu estat passar√† a ser <code>removed</code>.
<img alt="RAID1-17" src="../RAID1-15.png" /></p>
</li>
<li>
<p>Igualment podrem accedir a les dades 
<img alt="RAID1-18" src="../RAID1-18.png" /></p>
</li>
<li>
<p>Amb la mateixa comanda que hem utilitzat anteriorment amb el modificador <code>-a</code> afegirem de nou el disc. Com es pot apreciar primer trigarpa una estona ja que estar√† amb l'estat <code>spare rebuilding</code> passat un temps si tornem a detallar el RAID veurem que es troba en estat actiu.
<img alt="RAID1-19" src="../RAID1-19.png" />
<img alt="RAID1-20" src="../RAID1-20.png" /></p>
</li>
<li>
<p>Seguidament simularem un cas en el que un dels discs es trenca o te algun problema i es substituit per un de nou. Un cop hem extret el disc si fem un detail del RAID veurem que sol ens apareix un.
<img alt="RAID1-21" src="../RAID1-21.png" /></p>
</li>
<li>
<p>Per continuar aturarem tots els serveis i reinicaiarem el RAID toranant-lo a muntar. Veurem que les dades segueixen estant segures. I amb un detail veurem l'estat del RAID.
<img alt="RAID1-22" src="../RAID1-22.png" />
<img alt="RAID1-23" src="../RAID1-23.png" /></p>
</li>
<li>
<p>Per acabar afegirem el nou disc a la m√†quina i seguint la configuraci√≥ del principi el muntarem i prepararem. Tal i com ha passat abans amb el disc que hem desmuntat, quan posem un disc nou l'estat al RAID passa a ser <code>spare rebuilding</code>, un cop acaba, veiem que passa a actiu i que les dades segueixen all√†.
<img alt="RAID1-24" src="../RAID1-25.png" />
<img alt="RAID1-25" src="../RAID1-26.png" />
<img alt="RAID1-26" src="../RAID1-27.png" /></p>
</li>
<li>
<p>Finalment, esborrarem el RAID de forma definitiva. Es important tindre amb compte que l'estat del superblock es permanent. Llavors haurem de seguir les comandes seg√ºents:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>umount /dev/md0
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>mdadm --stop /dev/md0
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>mdadm --remove /dev/md0
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>rm -r /mnt/raid1
</code></pre></div>
<img alt="RAID1-27" src="../RAID1-28.png" /></p>
</li>
<li>
<p>Un cop hem parat els sistemes hem de eliminar les linies que hem creat al arxiu <code>fstab</code> i al <code>mdmda.conf</code>.
<img alt="RAID1-29" src="../RAID1-29.png" />
<img alt="RAID1-30" src="../RAID1-30.png" /></p>
</li>
<li>
<p>Com ja he esmentat abans, sino eliminem del tot el superblock la RAID seguir√† sense esborrar-se. Per tant les seg√ºents comandes son molt importants. Un cop executades podem fer un reinici del servei i del sistema.
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>mdadm --zero-superblock /dev/sdb1 /dev/sdc1
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>systemctl daemon-reload
</code></pre></div>
<img alt="RAID1-31" src="../RAID1-31.png" /></p>
</li>
</ul>
<h2 id="raid-5">RAID 5</h2>
<ul>
<li>
<p>En primer lloc, per fer una confiuraci√≥ del RAID 5, necessitarem com a minim dos discs que en un RAID 1, per tant es moment d'afegir els discs.
<img alt="RAID5-1" src="../RAID5-1.png" />
<img alt="RAID5-2" src="../RAID5-2.png" /></p>
</li>
<li>
<p>Com anteriorment ja hem vist com configurar els discs per muntar-los, ho farem igual per als quatre discs.
<img alt="RAID5-3" src="../RAID5-3.png" /></p>
</li>
<li>
<p>Amb la comanda <code>fdisk -l</code> comprovarem que tot estigui correctament.
<img alt="RAID5-4" src="../RAID5-4.png" />
<img alt="RAID5-5" src="../RAID5-5.png" /></p>
</li>
<li>
<p>Seugint els pasos igual que abans ara crearem la carpeta del RAID, el RAID, l'arxiu de configuraci√≥ i finalment muntarem la carpeta. Per ara son els mateixos procediments que amb el RAID 1. la diferencia principal es a la comanda:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>mdadm --create /dev/md0 --level=5 --raid-devices=5 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
</code></pre></div>
<img alt="RAID5-6" src="../RAID5-6.png" />
<img alt="RAID5-7" src="../RAID5-7.png" />
<img alt="RAID5-8" src="../RAID5-8.png" />
<img alt="RAID5-9" src="../RAID5-9.png" />
<img alt="RAID5-10" src="../RAID5-10.png" /></p>
</li>
<li>
<p>Un cop establerta la configuraci√≥ el que farem ser√† reiniciar el sistema i comprovar l'estat del RAID amb la comanda detail.
<img alt="RAID5-11" src="../RAID5-12.png" /></p>
</li>
<li>
<p>Per fer proves crearem un fitxer i un directori tal com hem fet abans.
<img alt="RAID5-13" src="../RAID5-13.png" /></p>
</li>
<li>
<p>La primera prova igual que l'anterior ser√† desactivar un dels discs i comprovar el funcionament.
<img alt="RAID5-14" src="../RAID5-14.png" />
<img alt="RAID5-15" src="../RAID5-15.png" /></p>
</li>
<li>
<p>Com s'aprecia la informaci√≥ es pot consultar igualment. Tamb√© podem veure que el comportament dels discs es igual amb tots els RAID per tant la diferencia radica en quants discs necessita el RAID per funcionar i per aix√≤ descativarem i borrarem els discs fins veure que la informaci√≥ no sigui visible.</p>
</li>
</ul>
<p><code>El propi sistema ja ens avisa de que amb dos discs fora no podr√† treballar</code>
<img alt="RAID5-16" src="../RAID5-16.png" /></p>
<ul>
<li>
<p>Per tant el que farem ser√† treure el disc "manualment".
<img alt="RAID5-17" src="../RAID5-17.png" />
<img alt="RAID5-18" src="../RAID5-18.png" /></p>
</li>
<li>
<p>Com podem veure l'estat passa a ser inactiu. En aquesta situaci√≥ el que haurem de fer es col¬∑locar un disc nou primer, formatar-lo i despr√©s recuperar el desactivat. Aquest es el cas m√©s extrany i mes complicat. Sino tot es molt paregut o igual al RAID1.
<img alt="RAID5-19" src="../RAID5-19.png" /></p>
</li>
<li>
<p>Com en aquest cas sol tenim 2 disc funcionant actualment l'array no arranca i ens donar√† problemes, si tenim el disc nou preparat i amb el format que tenia l'anterior el que farem ser√† obligar a l'array a reconstruir-se amb la seguent comanda:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>mdadm --assamble --force /dev/md0 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
</code></pre></div>
<img alt="RAID5-20" src="../RAID5-20.png" /></p>
</li>
<li>
<p>Un cop arrancat l'array comprovem quin es el seu estat i com podem veure ja funciona pero ens segueix fallant un dels discs que hem eliminat, el sdc. Ara no hi ha cap problema ja que el RAID funciona ara sol hem de muntar la part que ens falta.</p>
</li>
</ul>
<p><img alt="RAID5-21" src="../RAID5-21.png" />
<img alt="RAID5-22" src="../RAID5-22.png" /></p>
<ul>
<li>
<p>Com b√© sabem, tornem a afegir el disc que ens falta, el c, al RAID. Despr√©s comprovarem l'estat del RAID i de les dades.
<img alt="RAID5-23" src="../RAID5-23.png" />
<img alt="RAID5-24" src="../RAID5-24.png" /></p>
</li>
<li>
<p><code>En conclusi√≥ els errors son pareguts entre el RAID1 i RAID5. I si mai tenim el problema de que l'array no inicia la comanda clau un cop tenim els discs amb el seu format es:</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>mdadm --assamble --force /dev/md0
</code></pre></div></p>
</li>
<li>
<p>Per acabar desmuntarem el RAID5 com hem fet abans, seguint els passos de la captura. <code>I reiniciant el sistema</code>.
<img alt="RAID5-25" src="../RAID5-25.png" />
<img alt="RAID5-final" src="../RAID5-final.png" /></p>
</li>
</ul>
<h1 id="enllacos-dinteres-webgrafia">Enlla√ßos d'inter√©s / Webgrafia</h1>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>https://daniellop.com/que-es-raid-5/
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      
&copy; 2024 <a href="https://marcgnd.github.io/mkdocs-marc-sabate/Sprint1/#-llicencia-cc"  target="_blank" rel="noopener">Creative commons </a> 
<img src="./CC.png" width="70" height="70">

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>